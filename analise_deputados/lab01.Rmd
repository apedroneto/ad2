---
title: "Analise"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(magrittr)
library(tidyverse)
```


```{r}
dados <- read_csv(("dados/dadosCEAP.csv"))
```

```{r}
Parlamentar_gastos <- dados %>% group_by(nomeParlamentar) %>%
  summarise(gastos = sum(valorLíquido)) %>% 
  arrange(-gastos) %>% 
  slice(1:7)
  
Parlamentar_economia <- dados %>% group_by(nomeParlamentar) %>%
  summarise(gastos = sum(valorLíquido)) %>% 
  filter(gastos >= 0) %>% 
  arrange(gastos) %>% 
  slice(1:7)

ggplot(Parlamentar_economia, aes(x=nomeParlamentar, y=gastos)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=nomeParlamentar, 
                   xend=nomeParlamentar, 
                   y=0, 
                   yend=gastos)) + 
  labs(title="Economia dos parlamentares", 
       subtitle="Economias Vs Nomes Parlamentares", 
       caption="source: mpg") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))


ggplot(Parlamentar_gastos, aes(x=nomeParlamentar, y=gastos)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=nomeParlamentar, 
                   xend=nomeParlamentar, 
                   y=0, 
                   yend=gastos)) + 
  labs(title="Gastos dos parlamentares", 
       subtitle="Gastos Vs Nomes Parlamentares", 
       caption="source: mpg") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))

Estados_mais_gastos <- dados %>% group_by(sgUF) %>%
  summarise(gastos = sum(valorLíquido)) %>% 
  arrange(-gastos) %>% 
  filter(gastos > 0) %>% 
  slice(1:7)

ggplot(Estados_mais_gastos, aes(x=sgUF, y=gastos)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=sgUF, 
                   xend=sgUF, 
                   y=0, 
                   yend=gastos)) + 
  labs(title="Gastos dos Estados", 
       subtitle="Gastos Vs Estados", 
       caption="source: dados") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))

Estados_menos_gastos <- dados %>%   na.omit(sgUF) %>% 
  group_by(sgUF) %>% 
  summarise(gastos = sum(valorLíquido)) %>% 
  filter(gastos >= 0) %>% 
  arrange(gastos) %>% 
  slice(1:7)

ggplot(Estados_menos_gastos, aes(x=sgUF, y=gastos)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=sgUF, 
                   xend=sgUF, 
                   y=0, 
                   yend=gastos)) + 
  labs(title="Gastos dos Estados", 
       subtitle="Gastos Vs Estados", 
       caption="source: dados") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
  
```





